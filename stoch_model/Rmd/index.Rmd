---
title: "Analysis of early transmission of 2019-nCoV and implications for outbreaks in new locations"
output:
  html_document: default
  pdf_document: default
date: '`r format(Sys.time(), "%d %B, %Y")`'

---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

*Contributors: Adam Kucharski, Tim Russell, Charlie Diamond, CMMID nCoV working group, Sebastian Funk, Rosalind Eggo.*
*Note: this is preliminary analysis and has not yet been peer-reviewed.*

## Aim

To understand how human-to-human transmission varied in Wuhan during the early stages of the 2019-2020 nCoV outbreak, and implications for cases and outbreaks in new locations.

## Methods summary

• To estimate the early dynamics of transmission in Wuhan, we fitted a mathematical model to multiple available datasets on international exported cases from Wuhan and cases in Wuhan. Fitting to multiple data sources rather than a single dataset (or data point) is particularly useful for estimates in real-time, because some datasets may be unreliable. 

• Transmission was a random process in the model, and could vary over time -- this means the model can uncover fluctuations in transmission during the early stages of the outbreak. Our group previously used a similar analysis to understand the dynamics of [Ebola in Liberia](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5394640/).

• We assumed that the chance of cases being exported from Wuhan to other countries depended on the number of cases in Wuhan, the number of outbound travellers (accounting for travel restrictions after 23rd January), and the relative connectivity of different countries. We considered the 20 countries outside China most at risk of exported cases in the analysis. The model accounts for delays in symptom onset and reporting (see methods below).

## Key results

• **We estimated that the median effective reproduction number, R, had likely been fluctuating between 1.6-2.9 prior to travel restrictions being introduced on 23rd Jan (Figure 1F)**. (The effective reproduction number is the average number of secondary cases generated by a typical infectious individual at a given point in time, assuming a fully susceptible population).

• **More confirmed cases with a link to Wuhan have been reported in USA, Australia and France than our model predicted (Figure 1D)**. This may be the result of increased surveillance and detection as awareness of 2019-nCoV grew in late January, which would suggest earlier exported cases may have missed; it may also be the result of increased travel out of Wuhan immediately prior to travel restrictions being introduced on 23rd January.

• **Based on the median reproduction number observed during January before travel restrictions were introduced, we estimated that a single introduction of 2019-nCoV with SARS-like or MERS-like individual-level variation in transmission would have a 20–28% probability of causing a large outbreak (Figure 2A)**. Assuming SARS-like variation and Wuhan-like transmission, we estimated that once more than three infections have been introduced into a new location, there is an over 50% chance that an outbreak will occur (Figure 2B).


```{r fig_inference, echo=FALSE, fig.align='center', fig.cap="_Figure 1: Dynamics of transmission in Wuhan, fitted up to 28 January 2020. Red line marks travel restrictions starting on 23 January 2020. A) Onset dates of confirmed cases in Wuhan (triangles) and China (diamonds). Blue lines and shaded regions: median, 50% and 95% credible intervals of model estimate. B) Reported cases by date of onset (black) and estimated internationally exported cases from Wuhan by date of onset (blue line). C) Cumulative confirmed cases by date in Wuhan (circles) and estimated cumulative cases (blue line). D) International exportation events by date of confirmation of case, and expected number of exports in the fitted model. E) Estimated prevalence of symptomatic cases over time in Wuhan. F) Estimated daily reproduction number (R) over time. Datasets that were fitted to shown as solid points; non-fitted data shown as circles. _", out.width = '80%'}
knitr::include_graphics("../plots/cases_inference_1.png")
```

```{r fig_outbreak, echo=FALSE, fig.align='center', fig.cap="_Figure 2: Risk that introduced infections will establish in a new population. A) Probability a single case will lead to a large outbreak for different assumptions about the extent of homogeneity in individual-level transmission (i.e. the dispersion parameter k in a negative binomial offspring process). Results are shown for the median reproduction number estimated for nCoV-2019 in Wuhan between 1st January and 23rd January 2020 and. B) Probability a given number of introductions will result in a large outbreak, assuming SARS-like superspreading events can occur. _", out.width = '60%'}
knitr::include_graphics("../plots/R0_calc_1.png")
```

## Discussion, caveats and ongoing work

• We used biological parameters from current papers, but these may change as we get better data. We also made assumptions about the proportion of people who travel following the methods in the [J-IDEA reports](https://www.imperial.ac.uk/mrc-global-infectious-disease-analysis/news--wuhan-coronavirus/). However, jointly fitting to multiple datasets will reduce the influence that one single dataset has on results.

• The cumulative case totals in Figure 1E should in theory only increase over time; the drop seen in early case is likely the result of reclassification of cases.

• We use [connectivity estimates from MOBS lab](https://www.mobs-lab.org/2019ncov.html) for exported cases in our main analysis, but obtained similar results when using [WorldPop data](https://www.worldpop.org/events/china).

• The model is flexible, and this page will be updated as we incorporate new information and data.


## Detailed methods

#### Model

We used a stochastic SEIR model implemented using the Euler-Maruyama algorithm with a 6hr timestep, with transmission rate following geometric brownian motion (i.e. dlog(beta) = s dBt, where s is the volatility of transmission over time). We assume no travel out of Wuhan occurs after 23rd Jan, when restrictions were put in place. Cases that travel were distributed among other countries based on [risk inferred from connectivity to those countries](https://www.mobs-lab.org/2019ncov.html).

```{r fig_schematic, echo=FALSE, fig.align='center', fig.cap="_Figure 2: Model schematic. The population is divided into susceptible-exposed-infectious-removed classes, with a fraction of exposed individuals subsequently travelling and eventually being detected in their destination country_", out.width = '40%'}
knitr::include_graphics("../plots/schematic.png")
```

#### Fitting

We estimated the time-varying reproduction number using sequential Monte Carlo (SMC) by jointly fitting to three datasets:

1. Daily incidence of exported cases from Wuhan (or lack thereof) in countries with high connectivity to Wuhan (i.e. top 30 most at risk), by date of onset.  The most recent two data points are omitted during fitting as they are likely to be strongly influenced by delays in reporting. Source: [WHO](https://www.who.int/docs/default-source/coronaviruse/situation-reports/20200126-sitrep-6-2019--ncov.pdf) 

1. Daily incidence of initial cases in Wuhan with no market exposure, by date of onset. Source: Huang et al. Source: [Huang et al](https://www.nejm.org/doi/pdf/10.1056/NEJMoa2001316?articleTools=true).

1. Daily incidence of early cases in China, by date of onset. We assume that these are all in Wuhan. The most recent two data points were omitted during fitting as they are likely to be strongly influenced by delays in reporting. Source: [Liu et al](https://www.biorxiv.org/content/10.1101/2020.01.25.919787v1)

1. _Validation dataset (not used for fitting): Daily incidence of cases in Wuhan, by date of confirmation. Source: 1. Daily incidence of exported cases from Wuhan (or lack thereof) in countries with high connectivity to Wuhan (i.e. top 30 most at risk), by date of confirmation. Source: News reports, WHO, [Xu et al repo](http://virological.org/t/epidemiological-data-from-the-ncov-2019-outbreak-early-descriptions-from-publicly-available-data/337)_

To calculate the likelihood, we used a Poisson observation model fitted jointly to multiple model outputs. To calculate the daily expectation for each Poisson observation process, we converted the model (Figure 2) outputs into new case onset and new reported cases inside Wuhan and travelling internationally.  International onset data was not disaggregated by country and so we used the total daily exported cases in our Poisson probability calculation. We assumed a different relative reporting probability for Wuhan cases compared to international cases, as assumed only a proportion of confirmed Wuhan cases had known onset dates (fixed at 0.15 based on [available line list data](http://virological.org/t/epidemiological-data-from-the-ncov-2019-outbreak-early-descriptions-from-publicly-available-data/337)) 


Estimates for time-varying Rt generated by running 200 repetitions of SMC with 1000 particles. The transmission volatility and relative reporting of cases outside Wuhan were selected based on a grid search to find the marginal MLE. We assumed the outbreak started on 22nd November with 1 infectious individual and the population was initially fully susceptible. We also assumed all infectious people eventually became symptomatic and would be eventually be detected in destination country if they travelled by plane. We assumed that the population at risk was 10m (rather than 19m assumed in Imperial analysis) because most cases to date are adults and this group are more likely to travel. Model is available [on GitHub here](https://github.com/adamkucharski/2020-ncov).

### Branching process simulation model
We used a [branching process with a negative binomial offspring distribution](https://www.nature.com/articles/nature04153) to calculate the probability P that an outbreak starting with a single imported case would fail to go extinct (i.e. would cause a large outbreak). We also calculated the probability that an outbreak would occur after n introductions: 1–(1–P)^n

#### Parameters

Parameters used in the model are as follows. To improve realism based on early date, we assume the incubation and infectious period are Erlang distributed with rate 2.

| Parameter      | Value | Distribution | Source
| ----------- | ----------- | ----------- | ----------- |
| Incubation period      | 5.2 days       | Erlang (rate=2) | [Li et al](https://www.nejm.org/doi/pdf/10.1056/NEJMoa2001316?articleTools=true)
| Infectious period   | 2.9 days        | Erlang (rate=2) | [Liu et al](https://www.biorxiv.org/content/10.1101/2020.01.25.919787v1), [Xu et al](http://virological.org/t/epidemiological-data-from-the-ncov-2019-outbreak-early-descriptions-from-publicly-available-data/337)
| Delay onset-to-confirmation  | 6.1 days        | Exponential | [Xu et al](http://virological.org/t/epidemiological-data-from-the-ncov-2019-outbreak-early-descriptions-from-publicly-available-data/337)
| Daily outbound passengers   | 3300        | - | [J-IDEA](https://www.imperial.ac.uk/mrc-global-infectious-disease-analysis/news--wuhan-coronavirus/)
| Population at risk   | 11m        | - | [J-IDEA](https://www.imperial.ac.uk/mrc-global-infectious-disease-analysis/news--wuhan-coronavirus/)
| Initial cases   | 1        | - | [Andersen](http://virological.org/t/clock-and-tmrca-based-on-27-genomes/347)
| Introduction date  | 2019-11-22        | - | [Andersen](http://virological.org/t/phylodynamic-analysis-46-genomes-31-jan-2020/356)
| Proportion of cases with onsets known   | 0.15     | - | [Xu et al](https://github.com/beoutbreakprepared/nCoV2019)
| Relative reporting outside of Wuhan   | 67     | - | Estimated
| Transmission volatility   | 0.4        | - | Estimated




