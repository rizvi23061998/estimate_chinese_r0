china_population <- read_excel("data/chinesedata/population data-zwy.xlsx")
china_population <- china_population[!is.na(china_population$Region_EN),]
china_population$Region_EN <- make.unique(china_population$Region_EN)
data <- join(china_incidence,china_population,by = "Region_EN")
data <- data[data$Region_EN != "Wuhan",]
data$地区名称 <- NULL
data = data[which(data$Incidence != 0),]
# data = data[which(data$Recovery_R != 0),]
# data = data[which(data$Mortality != 0),]
#
new_data = data[,c("Incidence","Recovery_R","Mortality")]
cls=kmeans(new_data,3)
data$group <- cls$cluster
#
# n_data <- data[,!(colnames(data) %in% c("2018total","2018male","2018female","age 0-14","age15-64"  ,"age>65"))]
# n_data<- n_data[which(n_data$group==3),]
# print(n_data)
#
data_init <- data
group1 <- data_init[which(data_init$group == 1),"Region_EN"]
group2 <- data_init[which(data_init$group == 2),"Region_EN"]
group3 <- data_init[which(data_init$group == 3),"Region_EN"]
group1
group2
group3
library(factoextra)
new_data <- data#[,c("Region_EN","Incidence","Mortality","Recovery_R","group")]
rownames(new_data) <- new_data$Region_EN
new_data$Region_EN <- NULL
groups <- as.factor(new_data$group)
new_data$group <- NULL
res <- prcomp(new_data,scale = TRUE)
fviz_pca_ind(res,
col.ind = groups, # color by groups
palette = c("#00AFBB",  "#FC4E07","black"),
addEllipses = TRUE, # Concentration ellipses
ellipse.type = "confidence",
legend.title = "Groups",
repel = TRUE
)
library(readxl)
library(plyr)
set.seed(123)
china_incidence <- read_excel("data/chinesedata/Copy of China_C19.dbf.xlsx")
china_incidence <- china_incidence[!is.na(china_incidence$Region_EN),]
china_incidence$Region_EN <- make.unique(china_incidence$Region_EN)
china_population <- read_excel("data/chinesedata/population data-zwy.xlsx")
china_population <- china_population[!is.na(china_population$Region_EN),]
china_population$Region_EN <- make.unique(china_population$Region_EN)
data <- join(china_incidence,china_population,by = "Region_EN")
data <- data[data$Region_EN != "Wuhan",]
data$地区名称 <- NULL
data = data[which(data$Incidence != 0),]
# data = data[which(data$Recovery_R != 0),]
# data = data[which(data$Mortality != 0),]
#
new_data = data[,c("Incidence","Recovery_R","Mortality")]
cls=kmeans(new_data,3)
data$group <- cls$cluster
new_data <- cls$cluster
#
# n_data <- data[,!(colnames(data) %in% c("2018total","2018male","2018female","age 0-14","age15-64"  ,"age>65"))]
# n_data<- n_data[which(n_data$group==3),]
# print(n_data)
#
data_init <- data
group1 <- data_init[which(data_init$group == 1),"Region_EN"]
group2 <- data_init[which(data_init$group == 2),"Region_EN"]
group3 <- data_init[which(data_init$group == 3),"Region_EN"]
library(factoextra)
new_data <- new_data#[,c("Region_EN","Incidence","Mortality","Recovery_R","group")]
rownames(new_data) <- new_data$Region_EN
new_data$Region_EN <- NULL
groups <- as.factor(new_data$group)
new_data$group <- NULL
res <- prcomp(new_data,scale = TRUE)
fviz_pca_ind(res,
col.ind = groups, # color by groups
palette = c("#00AFBB",  "#FC4E07","black"),
addEllipses = TRUE, # Concentration ellipses
ellipse.type = "confidence",
legend.title = "Groups",
repel = TRUE
)
new_data
library(readxl)
library(plyr)
set.seed(123)
china_incidence <- read_excel("data/chinesedata/Copy of China_C19.dbf.xlsx")
china_incidence <- china_incidence[!is.na(china_incidence$Region_EN),]
china_incidence$Region_EN <- make.unique(china_incidence$Region_EN)
china_population <- read_excel("data/chinesedata/population data-zwy.xlsx")
china_population <- china_population[!is.na(china_population$Region_EN),]
china_population$Region_EN <- make.unique(china_population$Region_EN)
data <- join(china_incidence,china_population,by = "Region_EN")
data <- data[data$Region_EN != "Wuhan",]
data$地区名称 <- NULL
data = data[which(data$Incidence != 0),]
# data = data[which(data$Recovery_R != 0),]
# data = data[which(data$Mortality != 0),]
#
new_data = data[,c("Incidence","Recovery_R","Mortality")]
new_data <- apply(new_data, 2, scale)
cls=kmeans(new_data,3)
data$group <- cls$cluster
new_data <- cls$cluster
#
# n_data <- data[,!(colnames(data) %in% c("2018total","2018male","2018female","age 0-14","age15-64"  ,"age>65"))]
# n_data<- n_data[which(n_data$group==3),]
# print(n_data)
#
data_init <- data
group1 <- data_init[which(data_init$group == 1),"Region_EN"]
group2 <- data_init[which(data_init$group == 2),"Region_EN"]
group3 <- data_init[which(data_init$group == 3),"Region_EN"]
group1
group2
group3
library(factoextra)
new_data <- data[,c("Region_EN","Incidence","Mortality","Recovery_R","group")]#data_all
rownames(new_data) <- new_data$Region_EN
new_data$Region_EN <- NULL
groups <- as.factor(new_data$group)
new_data$group <- NULL
res <- prcomp(new_data,scale = TRUE)
fviz_pca_ind(res,
col.ind = groups, # color by groups
palette = c("#00AFBB",  "#FC4E07","black"),
addEllipses = TRUE, # Concentration ellipses
ellipse.type = "confidence",
legend.title = "Groups",
repel = TRUE
)
data
library(readxl)
library(plyr)
set.seed(123)
china_incidence <- read_excel("data/chinesedata/Copy of China_C19.dbf.xlsx")
china_incidence <- china_incidence[!is.na(china_incidence$Region_EN),]
china_incidence$Region_EN <- make.unique(china_incidence$Region_EN)
china_population <- read_excel("data/chinesedata/population data-zwy.xlsx")
china_population <- china_population[!is.na(china_population$Region_EN),]
china_population$Region_EN <- make.unique(china_population$Region_EN)
data <- join(china_incidence,china_population,by = "Region_EN")
data <- data[data$Region_EN != "Wuhan",]
data$地区名称 <- NULL
data = data[which(data$Incidence != 0),]
# data = data[which(data$Recovery_R != 0),]
# data = data[which(data$Mortality != 0),]
data <- drop_na(data)
#
new_data = data[,c("Incidence","Recovery_R","Mortality")]
new_data <- apply(new_data, 2, scale)
cls=kmeans(new_data,3)
data$group <- cls$cluster
new_data <- cls$cluster
#
# n_data <- data[,!(colnames(data) %in% c("2018total","2018male","2018female","age 0-14","age15-64"  ,"age>65"))]
# n_data<- n_data[which(n_data$group==3),]
# print(n_data)
#
data_init <- data
group1 <- data_init[which(data_init$group == 1),"Region_EN"]
group2 <- data_init[which(data_init$group == 2),"Region_EN"]
group3 <- data_init[which(data_init$group == 3),"Region_EN"]
#
library(factoextra)
new_data <- data[,c("Region_EN","Incidence","Mortality","Recovery_R","group")]#data_all
rownames(new_data) <- new_data$Region_EN
new_data$Region_EN <- NULL
groups <- as.factor(new_data$group)
new_data$group <- NULL
res <- prcomp(new_data,scale = TRUE)
fviz_pca_ind(res,
col.ind = groups, # color by groups
palette = c("#00AFBB",  "#FC4E07","black"),
addEllipses = TRUE, # Concentration ellipses
ellipse.type = "confidence",
legend.title = "Groups",
repel = TRUE
)
group1
group2
227+32
group3
227+32+39
write_rds(group1,"outputs/group1_incidence.rds")
write_rds(group2,"outputs/group2_incidence.rds")
write_rds(group3,"outputs/group3_incidence.rds")
write_rds(group1,"outputs/rds/group1_incidence.rds")
write_rds(group2,"outputs/rds/group2_incidence.rds")
write_rds(group3,"outputs/rds/group3_incidence.rds")
source('~/workspace/2020-ncov/stoch_model_V2_paper/scripts/main_model.R')
group1
source('~/workspace/2020-ncov/stoch_model_V2_paper/R/province_clustering.R')
fviz_pca_ind(res,
col.ind = groups, # color by groups
palette = c("#00AFBB",  "#FC4E07","black"),
addEllipses = TRUE, # Concentration ellipses
ellipse.type = "confidence",
legend.title = "Groups",
repel = TRUE
)
group1
group2
group3
source('~/workspace/2020-ncov/stoch_model_V2_paper/scripts/main_model.R')
source('~/workspace/2020-ncov/stoch_model_V2_paper/scripts/main_model.R')
source('~/workspace/2020-ncov/stoch_model_V2_paper/scripts/main_model.R')
source('~/workspace/2020-ncov/stoch_model_V2_paper/R/province_clustering.R')
source('~/workspace/2020-ncov/stoch_model_V2_paper/R/province_clustering.R')
fviz_pca_ind(res,
col.ind = groups, # color by groups
palette = c("#00AFBB",  "#FC4E07","black"),
addEllipses = TRUE, # Concentration ellipses
ellipse.type = "confidence",
legend.title = "Groups",
repel = TRUE
)
group1
source('~/workspace/2020-ncov/stoch_model_V2_paper/R/province_clustering.R')
source('~/workspace/2020-ncov/stoch_model_V2_paper/R/province_clustering.R')
group1
group2
group3
source('~/workspace/2020-ncov/stoch_model_V2_paper/scripts/main_model.R')
source('~/workspace/2020-ncov/stoch_model_V2_paper/scripts/main_model.R')
readRds("outputs/rds/group1_all.rds")
readRDS("outputs/rds/group1_all.rds")
readRDS("outputs/rds/group2_all.rds")
readRDS("outputs/rds/group3_all.rds")
source('~/workspace/2020-ncov/stoch_model_V2_paper/scripts/main_model.R')
source('~/workspace/2020-ncov/stoch_model_V2_paper/scripts/main_model.R')
source('~/workspace/2020-ncov/stoch_model_V2_paper/R/province_clustering.R')
group1
group2
group3
fviz_pca_ind(res,
col.ind = groups, # color by groups
palette = c("#00AFBB",  "#FC4E07","black"),
addEllipses = TRUE, # Concentration ellipses
ellipse.type = "confidence",
legend.title = "Groups",
repel = TRUE
)
source('~/workspace/2020-ncov/stoch_model_V2_paper/R/province_clustering.R')
source('~/workspace/2020-ncov/stoch_model_V2_paper/scripts/main_model.R')
source('~/workspace/2020-ncov/stoch_model_V2_paper/scripts/main_model.R')
source('~/workspace/2020-ncov/stoch_model_V2_paper/scripts/main_model.R')
source('~/workspace/2020-ncov/stoch_model_V2_paper/R/province_clustering.R')
group1
group2
group3
fviz_pca_ind(res,
col.ind = groups, # color by groups
palette = c("#00AFBB",  "#FC4E07","black"),
addEllipses = TRUE, # Concentration ellipses
ellipse.type = "confidence",
legend.title = "Groups",
repel = TRUE
)
source('~/workspace/2020-ncov/stoch_model_V2_paper/scripts/main_model.R')
source('~/workspace/2020-ncov/stoch_model_V2_paper/R/province_clustering.R')
source('~/workspace/2020-ncov/stoch_model_V2_paper/scripts/main_model.R')
source('~/workspace/2020-ncov/stoch_model_V2_paper/scripts/main_model.R')
source('~/workspace/2020-ncov/stoch_model_V2_paper/scripts/main_model.R')
source('~/workspace/2020-ncov/stoch_model_V2_paper/scripts/main_model.R')
source('~/workspace/2020-ncov/stoch_model_V2_paper/R/province_clustering.R')
source('~/workspace/2020-ncov/stoch_model_V2_paper/scripts/main_model.R')
source('~/workspace/2020-ncov/stoch_model_V2_paper/scripts/main_model.R')
source('~/workspace/2020-ncov/stoch_model_V2_paper/scripts/main_model.R')
source('~/workspace/2020-ncov/stoch_model_V2_paper/scripts/main_model.R')
source('~/workspace/2020-ncov/stoch_model_V2_paper/scripts/main_model.R')
source('~/workspace/2020-ncov/stoch_model_V2_paper/R/province_clustering.R')
group1
group2
group3
fviz_pca_ind(res,
col.ind = groups, # color by groups
palette = c("#00AFBB",  "#FC4E07","black"),
addEllipses = TRUE, # Concentration ellipses
ellipse.type = "confidence",
legend.title = "Groups",
repel = TRUE
)
source('~/workspace/2020-ncov/stoch_model_V2_paper/scripts/main_model.R')
source('~/workspace/2020-ncov/stoch_model_V2_paper/scripts/main_model.R')
source('~/workspace/2020-ncov/stoch_model_V2_paper/scripts/main_model.R')
s1<-read.csv('outputs/rds/group1_incidence.rds')
s1<-readRDS('outputs/rds/group1_incidence.rds')
s2<-readRDS('outputs/rds/group2_incidence.rds')
s3<-readRDS('outputs/rds/group3_incidence.rds')
s = [s1,s2,s3]
s1 + s2
class(s1)
s1
paste(s1,s2)
paste(s1,s2,sep = )
paste(s1,s2,sep = "")
z <- paste(s1,s2,sep = "")
length(z)
length(s2)
length(s1)
c(s1,s2)
s <- c(s1,s2,s3)
length(s)
s3<-readRDS('outputs/rds/group3_all.rds')
s2<-readRDS('outputs/rds/group2_all.rds')
s1<-readRDS('outputs/rds/group1_all.rds')
sa <- c(s1,s2,s3)
length(sa)
s[is.na(match(s,sa))]
write.csv(s,"states.csv")
write.csv(sa,"states_1.csv")
g1 <- readRDS("outputs/rds/group1_all.rds")
g2 <- readRDS("outputs/rds/group2_all.rds")
g3 <- readRDS("outputs/rds/group3_all.rds")
s <- read.csv("states.csv",header = F)
z = array(0,dim = nrow(s))
for (i in 1:nrow(s)){
# print(s[i,])
if( s[i,] %in% g1){
z[i] = 1
}else if(s[i,] %in% g2){
z[i] = 2
}else if(s[i,] %in% g3){
z[i] = 3
}
else{
z[i] <- NA
}
}
write.csv(z,"tmp.csv")
s
s <- read.csv("states.csv",header = F,row.names = F)
s <- s[,2]
s
s <- read.csv("states.csv",header = T)
s <- s[,2]
s
g1 <- readRDS("outputs/rds/group1_all.rds")
g2 <- readRDS("outputs/rds/group2_all.rds")
g3 <- readRDS("outputs/rds/group3_all.rds")
s <- read.csv("states.csv",header = T)
s <- s[,2]
z = array(0,dim = nrow(s))
for (i in 1:nrow(s)){
# print(s[i,])
if( s[i,] %in% g1){
z[i] = 1
}else if(s[i,] %in% g2){
z[i] = 2
}else if(s[i,] %in% g3){
z[i] = 3
}
else{
z[i] <- NA
}
}
write.csv(z,"tmp.csv")
g1 <- readRDS("outputs/rds/group1_all.rds")
g2 <- readRDS("outputs/rds/group2_all.rds")
g3 <- readRDS("outputs/rds/group3_all.rds")
s <- read.csv("states.csv",header = T)
s <- s[,2]
z = array(0,dim = length(s))
for (i in 1:length(s)){
# print(s[i,])
if( s[i,] %in% g1){
z[i] = 1
}else if(s[i,] %in% g2){
z[i] = 2
}else if(s[i,] %in% g3){
z[i] = 3
}
else{
z[i] <- NA
}
}
write.csv(z,"tmp.csv")
g1 <- readRDS("outputs/rds/group1_all.rds")
g2 <- readRDS("outputs/rds/group2_all.rds")
g3 <- readRDS("outputs/rds/group3_all.rds")
s <- read.csv("states.csv",header = T)
s <- s[,2]
z = array(0,dim = length(s))
for (i in 1:length(s)){
# print(s[i,])
if( s[i] %in% g1){
z[i] = 1
}else if(s[i] %in% g2){
z[i] = 2
}else if(s[i] %in% g3){
z[i] = 3
}
else{
z[i] <- NA
}
}
write.csv(z,"tmp.csv")
g1
z[1]
g2
s[2]
match(s[2],g2)
match(s[2],g3)
g3[8]
z[2]
g1 <- readRDS("outputs/rds/group1_incidence.rds")
g2 <- readRDS("outputs/rds/group2_incidence.rds")
g3 <- readRDS("outputs/rds/group3_incidence.rds")
s <- read.csv("states.csv",header = T)
s <- s[,2]
z = array(0,dim = length(s))
for (i in 1:length(s)){
# print(s[i,])
if( s[i] %in% g1){
z[i] = 1
}else if(s[i] %in% g2){
z[i] = 2
}else if(s[i] %in% g3){
z[i] = 3
}
else{
z[i] <- NA
}
}
write.csv(z,"tmp.csv")
type = "mf_ratio"
g1 <- readRDS(paste("outputs/rds/group1_",type,".rds",sep = ""))
g2 <- readRDS(paste("outputs/rds/group2_",type,".rds",sep = ""))
g3 <- readRDS(paste("outputs/rds/group3_",type,".rds",sep = ""))
s <- read.csv("states.csv",header = T)
s <- s[,2]
z = array(0,dim = length(s))
for (i in 1:length(s)){
# print(s[i,])
if( s[i] %in% g1){
z[i] = 1
}else if(s[i] %in% g2){
z[i] = 2
}else if(s[i] %in% g3){
z[i] = 3
}
else{
z[i] <- NA
}
}
write.csv(z,"tmp.csv")
type = "without_mf"
g1 <- readRDS(paste("outputs/rds/group1_",type,".rds",sep = ""))
g2 <- readRDS(paste("outputs/rds/group2_",type,".rds",sep = ""))
g3 <- readRDS(paste("outputs/rds/group3_",type,".rds",sep = ""))
s <- read.csv("states.csv",header = T)
s <- s[,2]
z = array(0,dim = length(s))
for (i in 1:length(s)){
# print(s[i,])
if( s[i] %in% g1){
z[i] = 1
}else if(s[i] %in% g2){
z[i] = 2
}else if(s[i] %in% g3){
z[i] = 3
}
else{
z[i] <- NA
}
}
write.csv(z,"tmp.csv")
type = "all_age"
g1 <- readRDS(paste("outputs/rds/group1_",type,".rds",sep = ""))
g2 <- readRDS(paste("outputs/rds/group2_",type,".rds",sep = ""))
g3 <- readRDS(paste("outputs/rds/group3_",type,".rds",sep = ""))
s <- read.csv("states.csv",header = T)
s <- s[,2]
z = array(0,dim = length(s))
for (i in 1:length(s)){
# print(s[i,])
if( s[i] %in% g1){
z[i] = 1
}else if(s[i] %in% g2){
z[i] = 2
}else if(s[i] %in% g3){
z[i] = 3
}
else{
z[i] <- NA
}
}
write.csv(z,"tmp.csv")
type = "temp"
g1 <- readRDS(paste("outputs/rds/group1_",type,".rds",sep = ""))
g2 <- readRDS(paste("outputs/rds/group2_",type,".rds",sep = ""))
g3 <- readRDS(paste("outputs/rds/group3_",type,".rds",sep = ""))
s <- read.csv("states.csv",header = T)
s <- s[,2]
z = array(0,dim = length(s))
for (i in 1:length(s)){
# print(s[i,])
if( s[i] %in% g1){
z[i] = 1
}else if(s[i] %in% g2){
z[i] = 2
}else if(s[i] %in% g3){
z[i] = 3
}
else{
z[i] <- NA
}
}
write.csv(z,"tmp.csv")
